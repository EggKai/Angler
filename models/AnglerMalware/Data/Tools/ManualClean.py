import pandas as pd
import sys

def keep_filepath_sha256_with_malware_zero(input_csv, output_csv):
    """
    Reads `input_csv` which contains columns [FilePath, SHA256, Imports, ...].
    Outputs a new CSV with columns [FilePath, SHA256, malware=0].
    """
    df = pd.read_csv(input_csv, dtype=str)

    # Create a new 'malware' column with value 0
    df['malware'] = 0
    
    # Keep only the desired columns
    columns_to_keep = ["FilePath", "SHA256", "malware"]
    df_reduced = df.loc[:, columns_to_keep]
    df_reduced = df_reduced.drop_duplicates(subset=["SHA256"])

    # Write to CSV
    df_reduced.to_csv(output_csv, index=False)

if __name__ == "__main__":
    # Example usage:
    input_csv  = str(sys.argv[1])   # CSV with FilePath, SHA256, Imports, etc.
    output_csv = "importless.csv"  # CSV with FilePath, SHA256, malware=0
    keep_filepath_sha256_with_malware_zero(input_csv, output_csv)
    print(f"Done. Reduced CSV saved to {output_csv}")
